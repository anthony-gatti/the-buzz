<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/NewComment.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/NewComment.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import "../styles/Comment.css";
/** 
 * The input section for adding a new comment
*/
function NewComment(props) {
    /**
     * Called when the user saves their new comment
     * Sends comment back to parent and backend
     */
    const addComment = () => {
      //Hide this component in display
      props.setAdd(false);
      //Get actual input element in this component
      const content = document.getElementById("content");
      //add comment and user to hook in parent containing new comments so we don't have to requery the backend
      props.addComment([...props.newComments, {
          content: content.value,
          user: props.getUser()
      }]);
      //Send Post request to backend to add the new comment to the database
      const addComment = async () => {
          try {
            const input = document.getElementById("content");
            const response = await fetch(`${import.meta.env.VITE_BACKEND_URL}/api/v3.0/comments/${props.mid}`, {
              method: 'POST',
              // send message as json object
              body: JSON.stringify({
                cContent: input.value,
              }),
              headers: {
                'Content-type': 'application/json; charset=UTF-8',
                'Session-Key': props.getToken()
              },
            });
            
            if (response.ok) {
              console.log("Comment added successfully"); 
              const data = await response.json();
              console.log(response);
            } else {
              // throw error if response is not okay
              throw new Error(`The server replied not ok: ${response.status}\n${response.statusText}`);
            }
          } catch (error) {
            // error if post request is rejected/ didnt go through
            console.warn('Something went wrong.', error);
            window.alert('Unspecified error');
          }
        }; // end of addComment
        addComment();
    }
    /**
     * Sends message back to parent to hide this component
     */
    const cancelNewPost = () => {
      props.setAdd(false);
    }
    /**
     * Returns actual html for this component
     * Label, input area, save and cancel buttons
     */
    return (
        &lt;>
        &lt;div className="comment">
            &lt;div>
                &lt;label htmlFor="content">Comment: &lt;/label>
                &lt;textarea data-testid="new-comment-input" id="content" name="content" rows="4" cols="50" >&lt;/textarea>
            &lt;/div>
            &lt;button className="save" id="contentSave" onClick={addComment}>Save&lt;/button>
            &lt;button className="cancel" onClick={cancelNewPost} >Cancel&lt;/button>
        &lt;/div>
        &lt;/>
    )
}
  
  export default NewComment;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#Bio">Bio</a></li><li><a href="global.html#Comment">Comment</a></li><li><a href="global.html#CommentsPage">CommentsPage</a></li><li><a href="global.html#Demographics">Demographics</a></li><li><a href="global.html#DisplayMessage">DisplayMessage</a></li><li><a href="global.html#DisplayPost">DisplayPost</a></li><li><a href="global.html#Header">Header</a></li><li><a href="global.html#Home">Home</a></li><li><a href="global.html#LikePost">LikePost</a></li><li><a href="global.html#NewComment">NewComment</a></li><li><a href="global.html#PersonalInfo">PersonalInfo</a></li><li><a href="global.html#backendUrl">backendUrl</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Tue Nov 14 2023 15:27:54 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
