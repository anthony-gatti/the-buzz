<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/DisplayPost.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/DisplayPost.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import DisplayMessage from "./DisplayMessage";
import React, { useState, useEffect } from 'react';
import "../styles/DisplayPost.css"

/** 
 * Displays a list of DisplayMessage components using data retrieved from backend/database
*/
const DisplayPost = (props) => {
  /**
   * Hook to hold the messages recieved from the backend/database
   */
  const [getMessages, setGetMessages] = useState([]);

    useEffect(() => {
        // start of fetch data
        const fetchData = async (key) => {
            try {
                // Make a GET request when the component mounts
                const response = await fetch(`${import.meta.env.VITE_BACKEND_URL}/api/v3.0/messages`, {
                  method: 'GET',
                  headers: {
                      'Content-type': 'application/json; charset=UTF-8',
                      'Session-Key': key
                  }
                });

                if (response.ok) {
                      // Put the response data into data and then set the messages to the data received from the server
                    const data = await response.json();
                    setGetMessages(data.mData);
                    console.log(data.mData);
                }else{ 
                  // throw error if the server response is not okay
                    throw new Error(`The server replied not ok: ${response.status}\n${response.statusText}`);
                }

            } catch (error) {
              // error if the get rquest was rejected/didn't go through
                console.warn('Error fetching messages:', error);
                window.alert('Unspecified error');
            }
        }; // end of fetch data
        let key = import.meta.env.VITE_SESSION_KEY;
        if(props.getToken() != ""){
          key = props.getToken();
        }
        fetchData(key);
        console.log(key);
    }, [props.getToken]); // The empty dependency array ensures this effect runs once after the initial render
    /**
     * Needs to be used to allow for functionality of comments page
     * @returns 1
     */
    const fakeGetVotes = () => {
      return 1;
    }
    /**
     * Returns the actual html code for this component.
     * A header as well as an unordered list of DisplayMessage
     * Note: the key prop is not used in the componenent, but needs to stay so there is alwyas a differentiating aspect
     */
    return (
      &lt;>
      &lt;h2 className="recentPosts">Recent Posts&lt;/h2>
      &lt;div className="messageSection">
          &lt;ul>
              {getMessages.map(message => (
                  &lt;DisplayMessage key={message.mId} title={message.mSubject} username={message.uUsername} message = {message.mMessage} getVotes={fakeGetVotes}
                    mid={message.mid} uid={message.uid} votes={message.mUpvotes - message.mDownvotes} changePage={props.changePage} getToken={props.getToken} 
                    upvoted={message.mIsUpvote} downvoted={message.mIsDownvote}/>
              ))}
          &lt;/ul>
      &lt;/div>
      &lt;/>
    );
  }; 

  export default DisplayPost;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#Bio">Bio</a></li><li><a href="global.html#Comment">Comment</a></li><li><a href="global.html#CommentsPage">CommentsPage</a></li><li><a href="global.html#Demographics">Demographics</a></li><li><a href="global.html#DisplayMessage">DisplayMessage</a></li><li><a href="global.html#DisplayPost">DisplayPost</a></li><li><a href="global.html#Header">Header</a></li><li><a href="global.html#Home">Home</a></li><li><a href="global.html#LikePost">LikePost</a></li><li><a href="global.html#NewComment">NewComment</a></li><li><a href="global.html#PersonalInfo">PersonalInfo</a></li><li><a href="global.html#backendUrl">backendUrl</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Tue Nov 14 2023 15:27:54 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
